$((function(){if(!window.history||!window.history.pushState||!window.history.replaceState)return;function e(){const e=document.getElementById("kratos-blog-post").offsetTop,t=document.getElementById("kratos-desktop-topnav").offsetHeight,n=t?e-t:0;$("body,html").animate({scrollTop:n},600)}function t(e,t,n){var o=e.querySelector('meta[property="'+t+'"]');if(o)n?o.setAttribute("content",n):o.parentNode&&o.parentNode.removeChild(o);else{if(!n)return;(o=e.createElement("meta")).setAttribute("property",t),o.setAttribute("content",n),e.head.appendChild(o)}}function n(e,t){const n=e.querySelector('meta[property="'+t+'"]');return n?n.getAttribute("content"):null}function o(e,n){if(document.title=e.title||"Untitled",n){const t=document.getElementById("main");"function"==typeof t.replaceWith?t.replaceWith(n.getElementById("main")):document.getElementById("main").innerHTML=e.content}else document.getElementById("main").innerHTML=e.content;const o=document.getElementById("main").getElementsByTagName("script");for(var r=0;r<o.length;r++){const e=o[r];if(!e.type||"text/javascript"===e.type.toLowerCase()){var i=document.createElement("script");i.setAttribute("type","text/javascript"),e.src?i.src=e.src:i.appendChild(document.createTextNode(e.text)),"function"==typeof e.replaceWith?e.replaceWith(i):(e.parentNode.insertBefore(i,e),e.parentNode.removeChild(e))}}t(document,"og:title",e.ogTitle),t(document,"og:url",e.ogUrl),OriginTitile=document.title}function r(e,t){return{url:e,title:t.title,ogTitle:n(t,"og:title"),ogUrl:n(t,"og:url"),content:t.getElementById("main").innerHTML}}window.addEventListener("popstate",(function(t){t.state&&(e(),void 0===t.state.content?c(t.state.url,!1):o(t.state),window.dispatchEvent(i.complete))}));const i={before:new Event("pjax:before"),success:new Event("pjax:success"),complete:new Event("pjax:complete"),error:new Event("pjax:error")};function c(t,n){const c=()=>{location.href=t,window.dispatchEvent(i.error)},l=new XMLHttpRequest;l.onerror=function(e){console.error(e),c(),bubbleNoticer("请求出错啦","err","3000")},l.ontimeout=function(){c()},l.onreadystatechange=function(){4===l.readyState&&(e=>{window.dispatchEvent(i.success);const c=document.implementation.createHTMLDocument("pjax");if(c.documentElement.innerHTML=e,!c.getElementById("main"))bubbleNoticer("似乎超时了，准备三秒后新建页面","problem","3000"),setTimeout((()=>{window.open(t)}),3500);else{history.replaceState(r(location.href,document),document.title,location.href);const e=r(t,c);bubbleNoticer("请求成功","ok","3000"),n&&window.history.pushState(e,e.title,e.url),o(e,c);const i=t.match(/\#.+$/);i&&$("body,html").animate({scrollTop:$(i[0]).offset().top-40},600)}NProgress.done(),window.dispatchEvent(i.complete)})(l.responseText)},l.open("GET",t,!0),l.timeout=6e3,"undefined"!=typeof load_comm&&null!==load_comm&&(load_comm=null),e(),NProgress.start(),bubbleNoticer("请求页面中","normal","3000"),window.dispatchEvent(i.before),l.send()}$(document).on("click","a[target!=_blank][rel!=gallery][class!=toc-link]",(function(){const e=$(this).attr("href");return void 0===e||(!!e.includes("javascript:")||(c(decodeURI(e),!0),!1))}))}));
//# sourceMappingURL=../maps/pjax.min.js.map
